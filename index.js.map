{"version":3,"file":"index.js","sources":["../src/js/artists.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\naxios.defaults.baseURL = 'https://sound-wave.b.goit.study/api';\nconst artistsList = document.querySelector('.artists-list');\nconst loadMoreBtn = document.querySelector('.load-more-btn');\nconst loader = document.querySelector('.loader');\nlet currentPage = 1;\nconst limit = 8;\n\nasync function fetchArtists(page) {\n    const response = await axios.get('/artists', {\n        params: {\n            page: page,\n            limit: limit,\n            sortName: 'asc'\n        }\n    });\n    return response.data;\n}\n// Обрізка біографіі\nfunction formatBio(text, maxWords = 20) {\n    if (!text) return \"\";\n    const firstDotIndex = text.indexOf('.');\n    const words = text.split(' ');\n\n    if (firstDotIndex !== -1) {\n        const textBeforeDot = text.substring(0, firstDotIndex + 1);\n        const wordsBeforeDot = textBeforeDot.split(' ').length;\n        if (wordsBeforeDot <= maxWords) return textBeforeDot;\n    }\n\n    if (words.length > maxWords) {\n        return words.slice(0, maxWords).join(' ') + '...';\n    }\n    return text;\n}\nfunction renderArtists(artists, shouldAppend = false) {\n    const markup = artists.map(({ _id, strArtist, strArtistThumb, genres, strBiographyEN }) => `\n        <li class=\"artist-item\">\n            <img src=\"${strArtistThumb}\" alt=\"${strArtist}\" class=\"artist-img\">\n            <div class=\"artist-info\">\n                <p class=\"genres\">${genres.join(', ')}</p>\n                <h3 class=\"artist-name\">${strArtist}</h3>\n                <p class=\"artist-bio\">${formatBio(strBiographyEN, 20)}</p> \n                <button type=\"button\" class=\"learn-more-btn\" data-id=\"${_id}\">Learn more</button>\n            </div>\n        </li>\n    `).join('');\n\n    if (shouldAppend) {\n        artistsList.insertAdjacentHTML('beforeend', markup);\n    } else {\n        artistsList.innerHTML = markup;\n    }\n}\nasync function loadArtists() {\n    try {\n        loader.classList.remove('is-hidden'); // Показуємо лоадер перед початком завантаження даних\n\n        loadMoreBtn.classList.add('is-hidden'); //Ховаємо поки поки йде завантаження нових\n\n        const data = await fetchArtists(currentPage);\n\n\n        renderArtists(data.artists, currentPage > 1);\n\n        // Ховаємо лодер колидосягли останньої сторінки\n        if (data.page >= data.totalPages) {\n            loadMoreBtn.classList.add('is-hidden');\n            if (currentPage > 1) {\n                iziToast.info({ message: \"Оппа! Це кінесь, більше нікого немає.\" });\n            }\n            // Показуємо лодер якщо є сторінки\n        } else {\n            loadMoreBtn.classList.remove('is-hidden');\n        }\n\n    } catch (error) {\n        iziToast.error({ message: \"Лишенько, щось пішло не так\" });\n    } finally {\n        loader.classList.add('is-hidden'); // Ховаємо лоадер ГАЛЕРЕЇ\n    }\n}\n\n\nloadArtists();\n\n\nloadMoreBtn.addEventListener('click', () => {\n    currentPage += 1;\n    loadArtists();\n}); \n"],"names":["axios","artistsList","loadMoreBtn","loader","currentPage","limit","fetchArtists","page","formatBio","text","maxWords","firstDotIndex","words","textBeforeDot","renderArtists","artists","shouldAppend","markup","_id","strArtist","strArtistThumb","genres","strBiographyEN","loadArtists","data","iziToast"],"mappings":"6vBAGAA,EAAM,SAAS,QAAU,sCACzB,MAAMC,EAAc,SAAS,cAAc,eAAe,EACpDC,EAAc,SAAS,cAAc,gBAAgB,EACrDC,EAAS,SAAS,cAAc,SAAS,EAC/C,IAAIC,EAAc,EAClB,MAAMC,EAAQ,EAEd,eAAeC,EAAaC,EAAM,CAQ9B,OAPiB,MAAMP,EAAM,IAAI,WAAY,CACzC,OAAQ,CACJ,KAAMO,EACN,MAAOF,EACP,SAAU,KACb,CACT,CAAK,GACe,IACpB,CAEA,SAASG,EAAUC,EAAMC,EAAW,GAAI,CACpC,GAAI,CAACD,EAAM,MAAO,GAClB,MAAME,EAAgBF,EAAK,QAAQ,GAAG,EAChCG,EAAQH,EAAK,MAAM,GAAG,EAE5B,GAAIE,IAAkB,GAAI,CACtB,MAAME,EAAgBJ,EAAK,UAAU,EAAGE,EAAgB,CAAC,EAEzD,GADuBE,EAAc,MAAM,GAAG,EAAE,QAC1BH,EAAU,OAAOG,CAC1C,CAED,OAAID,EAAM,OAASF,EACRE,EAAM,MAAM,EAAGF,CAAQ,EAAE,KAAK,GAAG,EAAI,MAEzCD,CACX,CACA,SAASK,EAAcC,EAASC,EAAe,GAAO,CAClD,MAAMC,EAASF,EAAQ,IAAI,CAAC,CAAE,IAAAG,EAAK,UAAAC,EAAW,eAAAC,EAAgB,OAAAC,EAAQ,eAAAC,CAAc,IAAO;AAAA;AAAA,wBAEvEF,CAAc,UAAUD,CAAS;AAAA;AAAA,oCAErBE,EAAO,KAAK,IAAI,CAAC;AAAA,0CACXF,CAAS;AAAA,wCACXX,EAAUc,EAAgB,EAAE,CAAC;AAAA,wEACGJ,CAAG;AAAA;AAAA;AAAA,KAGtE,EAAE,KAAK,EAAE,EAENF,EACAf,EAAY,mBAAmB,YAAagB,CAAM,EAElDhB,EAAY,UAAYgB,CAEhC,CACA,eAAeM,GAAc,CACzB,GAAI,CACApB,EAAO,UAAU,OAAO,WAAW,EAEnCD,EAAY,UAAU,IAAI,WAAW,EAErC,MAAMsB,EAAO,MAAMlB,EAAaF,CAAW,EAG3CU,EAAcU,EAAK,QAASpB,EAAc,CAAC,EAGvCoB,EAAK,MAAQA,EAAK,YAClBtB,EAAY,UAAU,IAAI,WAAW,EACjCE,EAAc,GACdqB,EAAS,KAAK,CAAE,QAAS,uCAAyC,CAAA,GAItEvB,EAAY,UAAU,OAAO,WAAW,CAG/C,MAAe,CACZuB,EAAS,MAAM,CAAE,QAAS,6BAA+B,CAAA,CACjE,QAAc,CACNtB,EAAO,UAAU,IAAI,WAAW,CACnC,CACL,CAGAoB,IAGArB,EAAY,iBAAiB,QAAS,IAAM,CACxCE,GAAe,EACfmB,GACJ,CAAC"}