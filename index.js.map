{"version":3,"file":"index.js","sources":["../src/js/modal.js","../src/js/artists.js"],"sourcesContent":["async function openArtistModal(artistId) {\n  console.log(artistId);\n}\n\nexport { openArtistModal };\n","import axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport { openArtistModal } from './modal.js';\naxios.defaults.baseURL = 'https://sound-wave.b.goit.study/api';\nconst artistsList = document.querySelector('.artists-list');\nconst loadMoreBtn = document.querySelector('.load-more-btn');\nconst loader = document.querySelector('.loader');\nlet currentPage = 1;\nconst limit = 8;\n\nartistsList.addEventListener('click', function (modalParameter) {\n  const btn = modalParameter.target.closest('.learn-more-btn');\n  if (!btn) return;\n\n  const artistId = btn.dataset.id;\n  openArtistModal(artistId);\n});\n\nasync function fetchArtists(page) {\n  const response = await axios.get('/artists', {\n    params: {\n      page: page,\n      limit: limit,\n      sortName: 'asc',\n    },\n  });\n  return response.data;\n}\n// Обрізка біографіі\nfunction formatBio(text, maxWords = 20) {\n  if (!text) return '';\n  const firstDotIndex = text.indexOf('.');\n  const words = text.split(' ');\n\n  if (firstDotIndex !== -1) {\n    const textBeforeDot = text.substring(0, firstDotIndex + 1);\n    const wordsBeforeDot = textBeforeDot.split(' ').length;\n    if (wordsBeforeDot <= maxWords) return textBeforeDot;\n  }\n\n  if (words.length > maxWords) {\n    return words.slice(0, maxWords).join(' ') + '...';\n  }\n  return text;\n}\nfunction renderArtists(artists, shouldAppend = false) {\n  const markup = artists\n    .map(\n      ({ _id, strArtist, strArtistThumb, genres, strBiographyEN }) => `\n        <li class=\"artist-item\">\n            <img src=\"${strArtistThumb}\" alt=\"${strArtist}\" class=\"artist-img\">\n            <div class=\"artist-info\">\n                <p class=\"genres\">${genres.join(', ')}</p>\n                <h3 class=\"artist-name\">${strArtist}</h3>\n                <p class=\"artist-bio\">${formatBio(strBiographyEN, 20)}</p> \n                <button type=\"button\" class=\"learn-more-btn\" data-id=\"${_id}\">Learn more</button>\n            </div>\n        </li>\n    `\n    )\n    .join('');\n\n  if (shouldAppend) {\n    artistsList.insertAdjacentHTML('beforeend', markup);\n  } else {\n    artistsList.innerHTML = markup;\n  }\n}\nasync function loadArtists() {\n  try {\n    loader.classList.remove('is-hidden'); // Показуємо лоадер перед початком завантаження даних\n\n    loadMoreBtn.classList.add('is-hidden'); //Ховаємо поки поки йде завантаження нових\n\n    const data = await fetchArtists(currentPage);\n\n    renderArtists(data.artists, currentPage > 1);\n\n    // Ховаємо лодер колидосягли останньої сторінки\n    if (data.page >= data.totalPages) {\n      loadMoreBtn.classList.add('is-hidden');\n      if (currentPage > 1) {\n        iziToast.info({ message: 'Оппа! Це кінесь, більше нікого немає.' });\n      }\n      // Показуємо лодер якщо є сторінки\n    } else {\n      loadMoreBtn.classList.remove('is-hidden');\n    }\n  } catch (error) {\n    iziToast.error({ message: 'Лишенько, щось пішло не так' });\n  } finally {\n    loader.classList.add('is-hidden'); // Ховаємо лоадер ГАЛЕРЕЇ\n  }\n}\n\nloadArtists();\n\nloadMoreBtn.addEventListener('click', () => {\n  currentPage += 1;\n  loadArtists();\n});\n"],"names":["openArtistModal","artistId","axios","artistsList","loadMoreBtn","loader","currentPage","limit","modalParameter","btn","fetchArtists","page","formatBio","text","maxWords","firstDotIndex","words","textBeforeDot","renderArtists","artists","shouldAppend","markup","_id","strArtist","strArtistThumb","genres","strBiographyEN","loadArtists","data","iziToast"],"mappings":"6vBAAA,eAAeA,EAAgBC,EAAU,CACvC,QAAQ,IAAIA,CAAQ,CACtB,CCEAC,EAAM,SAAS,QAAU,sCACzB,MAAMC,EAAc,SAAS,cAAc,eAAe,EACpDC,EAAc,SAAS,cAAc,gBAAgB,EACrDC,EAAS,SAAS,cAAc,SAAS,EAC/C,IAAIC,EAAc,EAClB,MAAMC,EAAQ,EAEdJ,EAAY,iBAAiB,QAAS,SAAUK,EAAgB,CAC9D,MAAMC,EAAMD,EAAe,OAAO,QAAQ,iBAAiB,EAC3D,GAAI,CAACC,EAAK,OAEV,MAAMR,EAAWQ,EAAI,QAAQ,GAC7BT,EAAgBC,CAAQ,CAC1B,CAAC,EAED,eAAeS,EAAaC,EAAM,CAQhC,OAPiB,MAAMT,EAAM,IAAI,WAAY,CAC3C,OAAQ,CACN,KAAMS,EACN,MAAOJ,EACP,SAAU,KACX,CACL,CAAG,GACe,IAClB,CAEA,SAASK,EAAUC,EAAMC,EAAW,GAAI,CACtC,GAAI,CAACD,EAAM,MAAO,GAClB,MAAME,EAAgBF,EAAK,QAAQ,GAAG,EAChCG,EAAQH,EAAK,MAAM,GAAG,EAE5B,GAAIE,IAAkB,GAAI,CACxB,MAAME,EAAgBJ,EAAK,UAAU,EAAGE,EAAgB,CAAC,EAEzD,GADuBE,EAAc,MAAM,GAAG,EAAE,QAC1BH,EAAU,OAAOG,CACxC,CAED,OAAID,EAAM,OAASF,EACVE,EAAM,MAAM,EAAGF,CAAQ,EAAE,KAAK,GAAG,EAAI,MAEvCD,CACT,CACA,SAASK,EAAcC,EAASC,EAAe,GAAO,CACpD,MAAMC,EAASF,EACZ,IACC,CAAC,CAAE,IAAAG,EAAK,UAAAC,EAAW,eAAAC,EAAgB,OAAAC,EAAQ,eAAAC,CAAc,IAAO;AAAA;AAAA,wBAE9CF,CAAc,UAAUD,CAAS;AAAA;AAAA,oCAErBE,EAAO,KAAK,IAAI,CAAC;AAAA,0CACXF,CAAS;AAAA,wCACXX,EAAUc,EAAgB,EAAE,CAAC;AAAA,wEACGJ,CAAG;AAAA;AAAA;AAAA,KAItE,EACA,KAAK,EAAE,EAENF,EACFjB,EAAY,mBAAmB,YAAakB,CAAM,EAElDlB,EAAY,UAAYkB,CAE5B,CACA,eAAeM,GAAc,CAC3B,GAAI,CACFtB,EAAO,UAAU,OAAO,WAAW,EAEnCD,EAAY,UAAU,IAAI,WAAW,EAErC,MAAMwB,EAAO,MAAMlB,EAAaJ,CAAW,EAE3CY,EAAcU,EAAK,QAAStB,EAAc,CAAC,EAGvCsB,EAAK,MAAQA,EAAK,YACpBxB,EAAY,UAAU,IAAI,WAAW,EACjCE,EAAc,GAChBuB,EAAS,KAAK,CAAE,QAAS,uCAAyC,CAAA,GAIpEzB,EAAY,UAAU,OAAO,WAAW,CAE3C,MAAe,CACdyB,EAAS,MAAM,CAAE,QAAS,6BAA+B,CAAA,CAC7D,QAAY,CACRxB,EAAO,UAAU,IAAI,WAAW,CACjC,CACH,CAEAsB,IAEAvB,EAAY,iBAAiB,QAAS,IAAM,CAC1CE,GAAe,EACfqB,GACF,CAAC"}